pkgname=dogfish
pkgver=1.1
pkgrel=1

pkgdesc="local chess ui, with engine."
url="https://github.com/bgfxc4/dogfish"
license=('GPL2')

arch=('any')
depends=('sfml')

source=("$pkgname-$pkgver.tar.gz::https://github.com/bgfxc4/dogfish/archive/refs/tags/$pkgver.tar.gz")
sha512sums=('d299c9ccb80a560f0dcec4ccdb327737da834e55ad9123ec19ff4794d8fef31d21282073b53b0e500acd73d847ddb895a240e3b7cd8c0cf2561e27b2f16cac4b')

build() {
	cd "$srcdir/$pkgname-$pkgver/gui"

	sed -i 's/"images/"\/usr\/share\/dogfish/g' board-ui.cpp graphics.cpp

	CXXFLAGS="$CXXFLAGS -std=c++2a"
	make release
}

package() {
	cd "$srcdir/$pkgname-$pkgver/gui"

	mkdir -p "$pkgdir/usr/bin"
	install main "$pkgdir/usr/bin/dogfish"

	mkdir -p "$pkgdir/usr/share/dogfish"
	mkdir -p "$pkgdir/usr/share/dogfish/figures"
	install -m644 -t "$pkgdir/usr/share/dogfish" images/*.png
	install -m644 -t "$pkgdir/usr/share/dogfish/figures" images/figures/*.png
}
